/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var h=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var T=Object.prototype.hasOwnProperty;var C=(a,e)=>{for(var t in e)h(a,t,{get:e[t],enumerable:!0})},R=(a,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of x(e))!T.call(a,n)&&n!==t&&h(a,n,{get:()=>e[n],enumerable:!(r=E(e,n))||r.enumerable});return a};var w=a=>R(h({},"__esModule",{value:!0}),a);var y={};C(y,{default:()=>d});module.exports=w(y);var c=require("obsidian");var l=[{"1mo":"1. Mose"},{"2mo":"2. Mose"},{"3mo":"3. Mose"},{"4mo":"4. Mose"},{"5mo":"5. Mose"},{jos:"Josua"},{ri:"Richter"},{ru:"Ruth"},{"1sam":"1. Samuel"},{"2sam":"2. Samuel"},{"1k\xF6":"1. K\xF6nige"},{"2k\xF6":"2. K\xF6nige"},{"1ch":"1. Chronika"},{"2ch":"2. Chronika"},{esr:"Esra"},{neh:"Nehemia"},{est:"Esther"},{hi:"Hiob"},{ps:"Psalm"},{spr:"Spr\xFCche"},{pred:"Prediger"},{hoh:"Hohes Lied"},{jes:"Jesaja"},{jer:"Jeremia"},{klag:"Klagelieder"},{hes:"Hesekiel"},{dan:"Daniel"},{hos:"Hosea"},{joe:"Joel"},{am:"Amos"},{ob:"Obadja"},{jon:"Jona"},{mi:"Micha"},{nah:"Nahum"},{hab:"Habakuk"},{zeph:"Zephanja"},{hag:"Haggai"},{sach:"Sacharja"},{mal:"Maleachi"},{mat:"Matth\xE4us"},{mar:"Markus"},{luk:"Lukas"},{joh:"Johannes"},{apg:"Apostelgeschichte"},{r\u00F6m:"R\xF6mer"},{"1kor":"1. Korinther"},{"2kor":"2. Korinther"},{gal:"Galater"},{eph:"Epheser"},{phil:"Philipper"},{kol:"Kolosser"},{"1thes":"1. Thessalonicher"},{"2thes":"2. Thessalonicher"},{"1tim":"1. Timotheus"},{"2tim":"2. Timotheus"},{tit:"Titus"},{philem:"Philemon"},{heb:"Hebr\xE4er"},{jak:"Jakobus"},{"1pet":"1. Petrus"},{"2pet":"2. Petrus"},{"1joh":"1. Johannes"},{"2joh":"2. Johannes"},{"3joh":"3. Johannes"},{jud:"Judas"},{offb:"Offenbarung"}];var j={},b=class extends c.EditorSuggest{constructor(e){super(e.app),this.plugin=e}onTrigger(e,t){let n=t.getLine(e.line).substring(0,e.ch),o=n.match(/(?:^|\s)(?:[-*+]\s+)?\/b\s+([a-z0-9äöüß]+\s*\d+:\d+(?:-\d+)?)?$/i),i=n.match(/(?:^|\s)(?:[-*+]\s+)?\/bo\s+([a-z0-9äöüß]+\s*\d+:\d+(?:-\d+)?)?$/i);if(!o&&!i)return null;let s=i||o;return s?{start:{ch:s.index+s[0].indexOf("/"),line:e.line},end:e,query:s[1]||""}:null}getSuggestions(e){let t=e.query,n=e.editor.getLine(e.start.line).substring(e.start.ch,e.start.ch+3)==="/bo";return t.match(/^[a-z0-9äöüß]+\s*\d+:\d+(?:-\d+)?$/i)?[{text:t,command:n?"open":"link"}]:[]}renderSuggestion(e,t){let r=e.command==="open"?"Convert and open":"Convert";t.setText(`${r} "${e.text}" to JW Library link`)}selectSuggestion(e){if(!this.context)return;let{context:t}=this,r=t.editor,n=this.plugin.convertBibleTextToMarkdownLink(e.text);if(r.replaceRange(`${n} `,t.start,t.end),e.command==="open"){let o=this.plugin.convertBibleTextToLink(e.text);window.open(o)}}},d=class extends c.Plugin{convertBibleReference(e){e=e.replace("jwpub://","jwlibrary://");let t=e.split("/"),r=t[t.length-1],[n,o]=r.split("-"),[i,s,g]=n.split(":"),[u,m,k]=o.split(":"),f=s.padStart(3,"0"),v=g.padStart(3,"0"),S=m.padStart(3,"0"),$=k.padStart(3,"0"),B=`${i}${f}${v}`,L=`${u}${S}${$}`;return`jwlibrary:///finder?bible=${`${B}-${L}`}`}convertPublicationReference(e){let t=e.split("/"),r=t[3],[n,o]=r.split(":"),i=t[4];return`jwlibrary:///finder?wtlocale=${n}&docid=${o}&par=${i}`}convertLinks(e,t){let r=/\[([^\]]+)\]\(([^)]+)\)/g;return e.replace(r,(n,o,i)=>i.startsWith("jwpub://b/")&&(t==="bible"||t==="all")?`[${o}](${this.convertBibleReference(i)})`:i.startsWith("jwpub://p/")&&(t==="publication"||t==="all")?`[${o}](${this.convertPublicationReference(i)})`:n)}convertBibleTextToLink(e){try{let t=this.parseBibleReference(e);return this.formatJWLibraryLink(t)}catch(t){return console.error("Error converting Bible text:",t.message),e}}parseBibleReference(e){e=e.trim().toLowerCase();let t=e.match(/^([a-z0-9äöüß]+?)(?:\s*(\d+)\s*:\s*(\d+)(?:\s*-\s*(\d+))?$)/i);if(!t)throw new Error("Invalid format");let[,r,n,o,i]=t,s=this.findBookIndex(r.trim());if(s===-1)throw new Error("Book not found");return{book:s<10?`0${s}`:s.toString(),chapter:n.padStart(3,"0"),verse:o.padStart(3,"0"),endVerse:i?i.padStart(3,"0"):void 0}}findBookIndex(e){e=e.toLowerCase().trim();for(let t=0;t<l.length;t++){let r=l[t],n=Object.keys(r)[0].toLowerCase();if(e===n)return t+1}return-1}formatJWLibraryLink(e){let t=`${e.book}${e.chapter}${e.verse}`,r=e.endVerse?`-${e.book}${e.chapter}${e.endVerse}`:"";return`jwlibrary:///finder?bible=${t}${r}`}formatBibleText(e){try{let t=this.parseBibleReference(e),r=parseInt(t.book)-1,n=l[r],o=Object.values(n)[0],i=t.endVerse?`${parseInt(t.verse)}-${parseInt(t.endVerse)}`:parseInt(t.verse);return`${o} ${parseInt(t.chapter)}:${i}`}catch(t){return e}}convertBibleTextToMarkdownLink(e){try{let t=this.convertBibleTextToLink(e),r=this.formatBibleText(e);return t!==e?`[${r}](${t})`:e}catch(t){return e}}async onload(){await this.loadSettings(),this.addCommand({id:"replace-links",name:"Replace all links",editorCallback:e=>{let t=e.getValue(),r=this.convertLinks(t,"all");t!==r&&e.setValue(r)}}),this.addCommand({id:"replace-bible-links",name:"Replace Bible verse links",editorCallback:e=>{let t=e.getValue(),r=this.convertLinks(t,"bible");t!==r&&e.setValue(r)}}),this.addCommand({id:"replace-publication-links",name:"Replace publication links",editorCallback:e=>{let t=e.getValue(),r=this.convertLinks(t,"publication");t!==r&&e.setValue(r)}}),this.addCommand({id:"convert-bible-text",name:"Convert Bible reference to Library link",editorCallback:e=>{let t=e.getSelection();if(t){let r=this.convertBibleTextToMarkdownLink(t);e.replaceSelection(r)}}}),this.addSettingTab(new p(this.app,this)),this.bibleSuggester=new b(this),this.registerEditorSuggest(this.bibleSuggester)}onunload(){}async loadSettings(){this.settings=Object.assign({},j,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}},p=class extends c.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t}display(){let{containerEl:e}=this;e.empty()}};
